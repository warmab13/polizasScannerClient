/*! rsapem-1.2.0.js (c) 2012-2017 Kenji Urushima | kjur.github.com/jsrsasign/license
 */
RSAKey.pemToBase64=function(b){var a=b;a=a.replace("-----BEGIN RSA PRIVATE KEY-----","");a=a.replace("-----END RSA PRIVATE KEY-----","");a=a.replace(/[ \n]+/g,"");return a};RSAKey.getPosArrayOfChildrenFromHex=function(g){var j=new Array();var i=ASN1HEX.getStartPosOfV_AtObj(g,0);var b=ASN1HEX.getPosOfNextSibling_AtObj(g,i);var e=ASN1HEX.getPosOfNextSibling_AtObj(g,b);var f=ASN1HEX.getPosOfNextSibling_AtObj(g,e);var l=ASN1HEX.getPosOfNextSibling_AtObj(g,f);var k=ASN1HEX.getPosOfNextSibling_AtObj(g,l);var d=ASN1HEX.getPosOfNextSibling_AtObj(g,k);var c=ASN1HEX.getPosOfNextSibling_AtObj(g,d);var h=ASN1HEX.getPosOfNextSibling_AtObj(g,c);j.push(i,b,e,f,l,k,d,c,h);return j};RSAKey.getHexValueArrayOfChildrenFromHex=function(f){var l=RSAKey.getPosArrayOfChildrenFromHex(f);var e=ASN1HEX.getHexOfV_AtObj(f,l[0]);var j=ASN1HEX.getHexOfV_AtObj(f,l[1]);var b=ASN1HEX.getHexOfV_AtObj(f,l[2]);var c=ASN1HEX.getHexOfV_AtObj(f,l[3]);var h=ASN1HEX.getHexOfV_AtObj(f,l[4]);var g=ASN1HEX.getHexOfV_AtObj(f,l[5]);var m=ASN1HEX.getHexOfV_AtObj(f,l[6]);var k=ASN1HEX.getHexOfV_AtObj(f,l[7]);var d=ASN1HEX.getHexOfV_AtObj(f,l[8]);var i=new Array();i.push(e,j,b,c,h,g,m,k,d);return i};RSAKey.prototype.readPrivateKeyFromPEMString=function(e){var c=RSAKey.pemToBase64(e);var d=b64tohex(c);var b=RSAKey.getHexValueArrayOfChildrenFromHex(d);this.setPrivateEx(b[1],b[2],b[3],b[4],b[5],b[6],b[7],b[8])};RSAKey.prototype.readPrivateKeyFromASN1HexString=function(a){this.readPKCS5PrvKeyHex(a)};RSAKey.prototype.readPKCS5PrvKeyHex=function(c){var b=RSAKey.getHexValueArrayOfChildrenFromHex(c);this.setPrivateEx(b[1],b[2],b[3],b[4],b[5],b[6],b[7],b[8])};RSAKey.prototype.readPKCS8PrvKeyHex=function(e){var c,j,l,b,a,f,d,k;var m=ASN1HEX;var g=m.getVbyList;if(m.isASN1HEX(e)===false){throw"not ASN.1 hex string"}try{c=g(e,0,[2,0,1],"02");j=g(e,0,[2,0,2],"02");l=g(e,0,[2,0,3],"02");b=g(e,0,[2,0,4],"02");a=g(e,0,[2,0,5],"02");f=g(e,0,[2,0,6],"02");d=g(e,0,[2,0,7],"02");k=g(e,0,[2,0,8],"02")}catch(i){throw"malformed PKCS#8 plain RSA private key"}this.setPrivateEx(c,j,l,b,a,f,d,k)};RSAKey.prototype.readPKCS5PubKeyHex=function(b){if(ASN1HEX.isASN1HEX(b)===false){throw"keyHex is not ASN.1 hex string"}var a=ASN1HEX.getPosArrayOfChildren_AtObj(b,0);if(a.length!==2||b.substr(a[0],2)!=="02"||b.substr(a[1],2)!=="02"){throw"wrong hex for PKCS#5 public key"}var d=ASN1HEX.getHexOfV_AtObj(b,a[0]);var c=ASN1HEX.getHexOfV_AtObj(b,a[1]);this.setPublic(d,c)};RSAKey.prototype.readPKCS8PubKeyHex=function(b){if(ASN1HEX.isASN1HEX(b)===false){throw"not ASN.1 hex string"}if(ASN1HEX.getDecendantHexTLVByNthList(b,0,[0,0])!=="06092a864886f70d010101"){throw"not PKCS8 RSA public key"}var a=ASN1HEX.getDecendantHexTLVByNthList(b,0,[1,0]);this.readPKCS5PubKeyHex(a)};RSAKey.prototype.readCertPubKeyHex=function(b,c){if(c!==5){c=6}if(ASN1HEX.isASN1HEX(b)===false){throw"not ASN.1 hex string"}var a=ASN1HEX.getDecendantHexTLVByNthList(b,0,[0,c]);this.readPKCS8PubKeyHex(a)};